services:
    keylight_entity_manager:
        class: KeylightUtilBundle\Services\EntityManager\EntityManager
        arguments:
            - @doctrine.orm.entity_manager
    keylight_twig_extension:
        class: KeylightUtilBundle\Services\Twig\KeylightTwigExtension
        arguments:
            - @keylight_string_formatter
            - @keylight_util_asset_provider
        public: false
        tags:
            - { name: twig.extension }
    keylight_string_formatter:
        class: KeylightUtilBundle\Services\String\StringFormatter
        arguments:
            - %locale%
    keylight_mailer:
        class: KeylightUtilBundle\Services\Mailer\MailerService
        arguments:
            - @mailer
            - %keylight_util_sender_address%
    keylight_s3_client_factory:
        class: KeylightUtilBundle\Services\Asset\AWS\S3ClientFactory
        arguments:
            - %keylight_util_s3_access_key_id%
            - %keylight_util_s3_secret_access_key%
    keylight_s3_client:
        class: Aws\S3\S3Client
        factory: keylight_s3_client_factory:getInstance
    keylight_s3_uploader:
        class: KeylightUtilBundle\Services\Asset\AWS\S3Uploader
        arguments:
            - @keylight_s3_client
            - %keylight_util_s3_bucket%
            - %keylight_util_s3_base_path%
    keylight_cloudfront_asset_provider:
        class: KeylightUtilBundle\Services\Asset\AWS\CloudfrontAssetProvider
        arguments:
            - %keylight_util_cloudfront_endpoint%
    keylight_local_asset_storage:
        class: KeylightUtilBundle\Services\Asset\Local\LocalAssetStorage
        arguments:
            - %kernel.root_dir%
    keylight_asset_manager:
        class: KeylightUtilBundle\Services\Asset\AssetManager
    keylight_generic_asset_handler:
        class: KeylightUtilBundle\Services\Asset\AssetHandlers\GenericAssetHandler
        arguments:
            - @keylight_util_asset_storage
            - @keylight_entity_manager
        public: false
        tags:
            - { name: keylight.asset_handler, priority: 255 }
    keylight_image_asset_handler:
        class: KeylightUtilBundle\Services\Asset\AssetHandlers\ImageAssetHandler
        arguments:
            - @keylight_util_asset_storage
            - %keylight_util_asset_images%
        public: false
        tags:
            - { name: keylight.asset_handler, priority: 50 }
    keylight_asset_sanitizer:
        class: KeylightUtilBundle\Services\Asset\AssetSanitizer
        arguments:
            - @keylight_asset_repository
            - @keylight_util_asset_provider
            - @keylight_asset_manager
            - @keylight_entity_manager
    keylight_asset_repository:
        class: Doctrine\ORM\EntityManager
        factory: doctrine.orm.entity_manager:getRepository
        arguments:
            - "KeylightUtilBundle:Asset"
    keylight_random_string_util:
        class: KeylightUtilBundle\Services\String\RandomStringUtil
